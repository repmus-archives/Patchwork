(in-package "PW");;---------------- add-to-midfil -------------------;;----------in pw->mf-write.lisp---------------(defun  write-midi-file (liste format nom-fich)  (let ((score-list (make-instance 'lp-scores))        (current-score (make-instance 'lp-score)))    (set-bits-per-beat current-score 480)           (setf  *tempo* 60 (slot-value current-score 'tempo-bpm) *tempo*)    (if (atom (caar liste))      (progn (setf  (events current-score) liste)             (push current-score (scores  score-list)))      (dolist (elt liste (setf (scores  score-list) (reverse (scores  score-list))))        (push (make-instance 'lp-score :events  elt) (scores  score-list))))    (track-writ-lp (flat  (mf-writ-lp score-list format)) nom-fich)));;----------in pw-midi-fil-write.lisp---------------(defun tempo-mf (score)  (let ((tmp (num->n-vals-n               (* (/ 60 (print (get-tempo-bpm score))) 500000))))    (append (list 0 255 81 (length tmp)) tmp)))