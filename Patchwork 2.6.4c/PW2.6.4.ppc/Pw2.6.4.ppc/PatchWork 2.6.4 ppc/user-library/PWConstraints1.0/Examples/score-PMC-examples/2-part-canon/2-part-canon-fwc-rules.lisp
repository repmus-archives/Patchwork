(in-package :PWCS) (* ?1 ?2 (?if  (member (- (m ?2) (m ?1)) '(1 -1 2 -2 3 -3 4 -4 5 -5 7 -7 12 -12 8 ))) "allowed ints") (* ?1 ?2 ?3 (?if (not (eq-SC? '(3-11a 3-11b 3-10 3-12) (m ?1) (m ?2) (m ?3)))) "no triads") (* ?1 ?2 ?3 ?4 ?5 ?6 (?if (>= (length (remove-duplicates (list (m ?1) (m ?2) (m ?3) (m ?4) (m ?5) (m ?6)))) 4))    "always 4 new pitches win = 6")  (* ?1 ?2 ?3 ?4 ?5 ?6     (?if (let ((midis (list (m ?1) (m ?2) (m ?3) (m ?4) (m ?5) (m ?6))))           (<= (apply #'max (mapcar #'(lambda (midi) (count midi midis)) midis)) 2))) "win = 6 pitch dupl max = 2") (* ?1 ?2 ?3 (?if (let ((n1 (m ?1)) (n2 (m ?2)) (n3 (m ?3))) (not (and (member (abs (- n3 n1)) '(6 10 14 11 13)) (up-down-movem? n1 n2 n3)))))     "avoid reaching tritone, 7th, 9th")  (* ?1 ?2 ?3 (?if (let ((n1 (m ?1)) (n2 (m ?2)) (n3 (m ?3))) (not (and (or (> (abs (- n2 n1)) 7) (> (abs (- n3 n2)) 7)) (up-down-movem? n1 n2 n3)))))    "counter-movement")  (* ?1 ?2 ?3 (?if (if (>= (abs (- (m ?2) (m ?1))) 7) (<= (abs (- (m ?2) (m ?3))) 2) t)) "after big jump stepwise movement")  (* ?1 ?2 ?3 (?if (ballistic? (m ?1) (m ?2) (m ?3))) "ballistic")  (* ?1 ?2 ?3 ?4 (?if (upbeat-dissonance? ?1 ?2 ?3 ?4)) "upbeat neighboring notes, passing notes and cambiata") (* ?1 ?2 ?3  (?if (if (or (match-rtm? (2 (3 (?2 1))))            ; 1.                           (match-rtm? (1 (1.0 (?2 1)))))                      (if (and (or  (= (- (m ?2) (m ?1)) -1) (= (- (m ?2) (m ?1)) -2))                                 (< (durt ?2) (durt ?3)))            ; 3.                         (> (- (m ?3) (m ?2)) 0)                    ; 4.                                                            (<= (abs (- (m ?3) (m ?2))) 4))            ; 5.                     t)) "dotted or slurred upbeat 1/8 note mel rule")                   