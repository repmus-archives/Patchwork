(in-package "PW");***********************************************************;tirages aleatoire de repartition 1/f(defun un-sur-effe (n x p)  "n est le nombre de tirages, x est le nombre de dsp est le nombre de face par d"  (let ((L ()) Ndesprec Ndessuiv        (Nbinprec (make-list x :initial-element 0))  ; 1        Nbinsuiv)    (repeat x (push (random p) Ndesprec))            ; 2    (push (apply '+ Ndesprec) L)                     ; 3    (dotimes (m n)      (setf Nbinsuiv (dec->bin (random (expt 2 x)) x))    ; 4      (dotimes (i x (setf Ndessuiv (reverse Ndessuiv)))         (if (= (nth i Nbinprec)(nth i Nbinsuiv))          (push (nth i Ndesprec) Ndessuiv)           ; 5          (push (random p) Ndessuiv)))               ; 5       (push (apply '+ Ndessuiv) L)                  ; 6      (setf Ndesprec Ndessuiv                        ; 7            Ndessuiv ()            Nbinprec Nbinsuiv                        ; 7            Nbinsuiv ()))    (butlast (reverse L))));(un-sur-effe 10 3 6)-->(9 4 4 5 8 9 5 6 6 4)(defun dec->bin (n &optional max)  "pour ecrire n en binaire, max est la longueur de la liste resultat"  (let ((L ()))    (multiple-value-bind (q r)(floor n 2)      (while (or max (> q 0))        (if max (setf max (if (> max 2)(1- max)())))        (progn (push r L)               (multiple-value-bind (q2 r2)(floor q 2)                 (setf q q2 r r2)))) (push r L))));(dec->bin 3 3)-->(0 1 1)(PW-addmenu *Utils-lp* '(un-sur-effe))