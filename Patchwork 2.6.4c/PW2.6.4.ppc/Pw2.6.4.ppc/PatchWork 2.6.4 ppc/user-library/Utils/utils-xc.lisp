;;;;======================================================================================;;;;[chabot] 18.1.94               utils.lisp;;;;;;;;      ;;;;=======================================================================================(in-package :pw)(export '(strip-ext strip-pathname));; utilities to strip path off(defunp strip-pathname ((pathname list (:type-list (string)))) string"takes a pathname with ; or : and strips off the path to return the fine name only"  (cond ((and pathname (listp pathname) (mapcar #'strip-pathname pathname)))        (pathname           (setf pathname (mac-namestring  pathname))         (let (pos1 pos2 subname)           (setf pos1 (position #\: pathname :from-end t));; strip : off pathname           (setf pos2 (position #\; pathname :from-end t)) ;; strip  ; off pathname           (cond ((and pos1 pos2)  ;; check if ; or : was found and take the right most one                  (setf subname (subseq pathname (if (> pos1 pos2) (1+ pos1) (1+ pos2)))))                 (pos1 (setf subname (subseq pathname (1+ pos1 ))))                 (pos2 (setf subname (subseq pathname (1+ pos2 ))))                 )           subname))        (t ())))(defunp strip-ext ((filename list (:type-list (string)))) string        "takes a filename string and stipps off the extension"  (cond ((and filename (listp filename) (mapcar #'strip-ext filename)))        (filename         (setf filename (mac-namestring filename))         (let (pos subname)           (setf pos (position #\. filename :from-end t)) ;; strip off extension           (setf subname (if pos (subseq filename 0 pos) filename))           subname))        (t ()))  )(PW-addmenu *Utils-lp* '(                         ;strip-pathname                          strip-ext                         ))