;; ==================================================================================== ;;                                PAQUET   SEQUENCES ALEATOIRES;; ==================================================================================== ;;          V1.0;;                                 functions by Mikhail Malt   1991 Paris IRCAM(in-package "ALEA")(import '(epw::random2 epw::L+))(ccl::export '(not-centr alea-seq linea-seq triang-seq))(defunp not-centr ((nc midic)  (intv fix)) chord "Returns an aleatoric pitch value between <nc-intv> and <nc+intv>."  (L+ nc (* 100(- intv (random (+ 1 (* 2 intv)))))))(defunp alea-seq ((nc midic) (intv fix) (long fix>0)) list"Aleatoric sequence of a uniform distribution, between <nc-intv> and <nc+intv> with a  length <long>."(let ((res))(for(i 1 1 long) (newl res (L+ (if (listp nc) (car nc) nc) (* 100(- intv (random (+ 1 (* 2 intv)))))))) (nreverse res))) (defunp linea-seq (  (long fix>0) (limsup midic) (liminf midic)) chord"Aleatoric sequence of a lineair distribution, between <lim.inf> and <lim.sup> with a length <long>."(let ((res))(for(i 1 1 long) (newl res (l+ liminf (*  (- limsup liminf)                               (- 1 (sqrt (/ (random 1000) 1000))))))) (nreverse res))) (defunp triang-seq ((long fix>0) (limsup midic) (liminf midic)) chord"Aleatoric sequence of a triangular distribution, between <lim.inf> and <lim.sup> with a length <long>."(let ((res))(for(i 1 1 long) (newl res (L+ liminf (* (- limsup liminf)                                          (/ (+ (/(random 1000.0) 1000.0) (/(random 1000.0) 1000.0)) 2)                                         )))) (nreverse res))) 